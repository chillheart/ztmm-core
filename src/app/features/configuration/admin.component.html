<div class="container-fluid">
  <div class="row">
    <div class="col-12">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="mb-0">
          <i class="bi bi-gear-fill text-primary me-2"></i>
          Configuration
        </h2>
        <div class="d-flex align-items-center gap-3">
          <!-- V1/V2 Model Toggle -->
          <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" role="switch" id="modelToggle" 
                   [(ngModel)]="useV2Model" (change)="toggleDataModel()">
            <label class="form-check-label" for="modelToggle">
              <span class="badge" [class.bg-primary]="useV2Model" [class.bg-secondary]="!useV2Model">
                {{ useV2Model ? 'V2 Model' : 'V1 Model' }}
              </span>
            </label>
          </div>
          <div class="text-muted">
            <small>Manage your ZTMM framework components</small>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="admin-nav">
    <ul class="nav nav-pills nav-fill mb-4" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link d-flex align-items-center justify-content-center"
                [class.active]="activeTab === 'pillars'"
                (click)="activeTab = 'pillars'"
                type="button">
          <i class="bi bi-building me-2"></i>
          <span>Pillars</span>
          <span class="badge bg-light text-dark ms-2">{{ pillars.length }}</span>
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link d-flex align-items-center justify-content-center"
                [class.active]="activeTab === 'functions'"
                (click)="activeTab = 'functions'"
                type="button">
          <i class="bi bi-layers me-2"></i>
          <span>Functions/Capabilities</span>
          <span class="badge bg-light text-dark ms-2">{{ functionCapabilities.length }}</span>
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link d-flex align-items-center justify-content-center"
                [class.active]="activeTab === 'tech'"
                (click)="activeTab = 'tech'"
                type="button">
          <i class="bi bi-tools me-2"></i>
          <span>Technologies/Processes</span>
          <span class="badge bg-light text-dark ms-2">{{ technologiesProcesses.length }}</span>
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link d-flex align-items-center justify-content-center"
                [class.active]="activeTab === 'management'"
                (click)="activeTab = 'management'"
                type="button">
          <i class="bi bi-gear-wide-connected me-2"></i>
          <span>Data Management</span>
        </button>
      </li>
    </ul>
  </div>
<div [ngSwitch]="activeTab" class="admin-content">
  <!-- PILLARS TAB -->
  <div *ngSwitchCase="'pillars'">
    <app-pillars-tab
      [pillars]="pillars"
      (addPillar)="onAddPillar($event)"
      (removePillar)="onRemovePillar($event)"
      (editPillar)="onEditPillar($event)"
      (savePillarOrder)="onSavePillarOrder($event)">
    </app-pillars-tab>
  </div>
  <!-- FUNCTIONS/CAPABILITIES TAB -->
  <div *ngSwitchCase="'functions'">
    <app-functions-tab
      [pillars]="pillars"
      [functionCapabilities]="functionCapabilities"
      (addFunctionCapability)="onAddFunctionCapability($event)"
      (removeFunctionCapability)="onRemoveFunctionCapability($event)"
      (editFunctionCapability)="onEditFunctionCapability($event)"
      (saveFunctionOrder)="onSaveFunctionOrder($event)">
    </app-functions-tab>
  </div>
  <!-- TECHNOLOGIES/PROCESSES TAB -->
  <div *ngSwitchCase="'tech'">
    <!-- Show info banner about V1/V2 -->
    <div class="alert" [class.alert-info]="!useV2Model" [class.alert-success]="useV2Model" role="alert">
      <i class="bi" [class.bi-info-circle-fill]="!useV2Model" [class.bi-check-circle-fill]="useV2Model"></i>
      <strong>{{ useV2Model ? 'V2 Model Active' : 'V1 Model Active' }}</strong>
      <p class="mb-0 mt-2">
        <span *ngIf="!useV2Model">
          You are viewing the legacy V1 data model where each technology/process is tied to a single maturity stage.
        </span>
        <span *ngIf="useV2Model">
          You are viewing the new V2 data model where technologies/processes can span multiple maturity stages with detailed implementations for each stage.
        </span>
      </p>
    </div>

    <!-- V1 UI -->
    <app-technologies-tab *ngIf="!useV2Model"
      [pillars]="pillars"
      [functionCapabilities]="functionCapabilities"
      [maturityStages]="maturityStages"
      [technologiesProcesses]="technologiesProcesses"
      (addTechnologyProcess)="addOrEditTechnologyProcess($event)"
      (removeTechnologyProcess)="onRemoveTechnologyProcess($event)"
      (editTechnologyProcess)="addOrEditTechnologyProcess($event)"
      (loadTechnologiesProcesses)="onLoadTechnologiesProcesses()">
    </app-technologies-tab>

    <!-- V2 UI -->
    <app-technologies-v2-tab *ngIf="useV2Model"
      [pillars]="pillars"
      [functionCapabilities]="functionCapabilities"
      [maturityStages]="maturityStages"
      [processTechnologyGroups]="processTechnologyGroups"
      (addProcessTechnologyGroup)="onAddProcessTechnologyGroup($event)"
      (removeProcessTechnologyGroup)="onRemoveProcessTechnologyGroup($event)"
      (editProcessTechnologyGroup)="onEditProcessTechnologyGroup($event)">
    </app-technologies-v2-tab>
  </div>
  <!-- DATA MANAGEMENT TAB -->
  <div *ngSwitchCase="'management'">
    <app-data-management-tab
      [dataStatistics]="dataStatistics"
      [isExporting]="isExporting"
      [isImporting]="isImporting"
      [isResetting]="isResetting"
      [isGeneratingDemo]="isGeneratingDemo"
      [demoDataExists]="demoDataExists"
      [demoDataStats]="demoDataStats"
      (exportData)="exportData()"
      (fileSelected)="onFileSelected($event)"
      (resetDatabase)="resetDatabase()"
      (generateDemoData)="onGenerateDemoData()">
    </app-data-management-tab>
  </div>
</div>

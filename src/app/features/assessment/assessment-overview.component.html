<div class="assessment-overview-container">
  <!-- Header -->
  <div class="card shadow-sm mb-4">
    <div class="card-header bg-primary text-white">
      <div class="d-flex justify-content-between align-items-center">
        <div class="d-flex align-items-center gap-3">
          <!-- Back Button -->
          <button type="button" class="btn btn-sm btn-outline-light" (click)="onBackToPillarSummary()">
            <i class="bi bi-arrow-left"></i> Back
          </button>
          <div>
            <h5 class="mb-0">
              <i class="bi bi-list-check"></i>
              {{ selectedFunctionCapabilityType }}: {{ selectedFunctionCapabilityName }}
            </h5>
            <small class="text-white-50">Multi-Stage Assessment</small>
          </div>
        </div>
        <div class="d-flex align-items-center gap-3">
          <!-- Progress Badge -->
          <div class="badge bg-light text-dark fs-6">
            <i class="bi bi-graph-up"></i>
            {{ getCurrentProgress() }}% Complete
          </div>
          <!-- Auto-save Indicator -->
          <span *ngIf="isAutoSaving" class="text-white-50">
            <i class="bi bi-cloud-upload spinning"></i>
            Saving...
          </span>
          <span *ngIf="showSuccess" class="text-success">
            <i class="bi bi-check-circle-fill"></i>
            Saved
          </span>
        </div>
      </div>
    </div>

    <div class="card-body">
      <!-- Summary Stats -->
      <div class="row g-3 mb-3">
        <div class="col-md-3">
          <div class="d-flex align-items-center">
            <i class="bi bi-collection fs-4 text-primary me-2"></i>
            <div>
              <div class="text-muted small">Total Items</div>
              <div class="fw-bold">{{ processTechnologyGroups.length }}</div>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="d-flex align-items-center">
            <i class="bi bi-check-circle fs-4 text-success me-2"></i>
            <div>
              <div class="text-muted small">Assessed</div>
              <div class="fw-bold">
                {{ getAssessedCount() }}
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="d-flex align-items-center">
            <i class="bi bi-hourglass-split fs-4 text-warning me-2"></i>
            <div>
              <div class="text-muted small">In Progress</div>
              <div class="fw-bold">
                {{ getInProgressCount() }}
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="d-flex align-items-center">
            <i class="bi bi-circle fs-4 text-secondary me-2"></i>
            <div>
              <div class="text-muted small">Not Started</div>
              <div class="fw-bold">
                {{ getNotStartedCount() }}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

  <!-- Assessment Items -->
  <div class="assessment-items p-3">
    <div *ngIf="processTechnologyGroups.length === 0" class="alert alert-info">
      <i class="bi bi-info-circle"></i>
      No process/technology groups found for this function/capability.
    </div>

    <div *ngFor="let group of processTechnologyGroups; let i = index" class="mb-3">
      <app-assessment-item
        [group]="group"
        [itemNumber]="i + 1"
        [assessment]="getAssessment(group.id)"
        [stageImplementations]="getStageImplementations(group.id)"
        [stageImplementationDetails]="getStageDetails(group.id)"
        [functionCapabilities]="functionCapabilities"
        [maturityStages]="maturityStages"
        [statusOptions]="statusOptions"
        (assessmentChange)="onAssessmentUpdate(group.id, $event)">
      </app-assessment-item>
    </div>
  </div>
</div>
